# Poker Flip App

ポーカーハンド評価機能付きのPWA（Progressive Web App）です。テキサスホールデムポーカーの手役判定とチョップ検出が可能です。

## 🚀 主要機能

### ポーカーハンド評価
- **7枚から最強の5枚を自動選択** - 組み合わせ生成による正確な評価
- **全役対応** - ロイヤルフラッシュ、ストレートフラッシュ、フォーカード、フルハウス、フラッシュ、ストレート、スリーカード、ツーペア、ワンペア、ハイカード
- **正確なストレート判定** - A-2-3-4-5（ホイール）も正しく判定
- **チョップ検出** - 同じ手の強さのプレイヤーを自動検出して「チョップ」表示

### PWA機能
- **ホーム画面追加** - スマホのホーム画面にアプリとして追加可能
- **オフライン対応** - Service Workerによるキャッシュ機能
- **スタンドアロンモード** - ブラウザUIなしでアプリとして起動

### フィードバック機能
- **Netlify Forms** - バグ報告・コメント送信機能
- **ソーシャルシェア** - X（Twitter）とLINEでのシェアボタン

## 🛠 技術仕様

### ポーカーハンド評価アルゴリズム
```javascript
// 7枚から5枚を選ぶ全組み合わせ（21通り）を生成
function generateCombinations(arr, start, current) {
  if (current.length === 5) {
    combinations.push([...current]);
    return;
  }
  for (let i = start; i < arr.length; i++) {
    current.push(arr[i]);
    generateCombinations(arr, i + 1, current);
    current.pop();
  }
}

// 各組み合わせを評価して最強の手を選択
const score = handEval.category * 1000 + (handEval.kickerRanks[0] || 0);
```

### 役の強さ（カテゴリ）
- 8: ストレートフラッシュ
- 7: フォーカード
- 6: フルハウス
- 5: フラッシュ
- 4: ストレート
- 3: スリーカード
- 2: ツーペア
- 1: ワンペア
- 0: ハイカード

### キッカーランク生成
- **ストレート**: ハイカードのみで比較
- **ツーペア**: 高いペア → 低いペア → キッカーの順
- **ワンペア**: ペア → キッカー3枚の順
- **ハイカード**: ランクの降順

## 📁 ファイル構成

- `index.html` - メインアプリ（PWA設定、フィードバックフォーム、キャッシュ制御）
- `cards.js` - ポーカーハンド評価ロジック（`evaluateSeven`, `describeBestHand`, `compareHands`）
- `cards.css` - カードUIとアニメーション
- `sw.js` - Service Worker（PWAキャッシュ）
- `manifest.json` - PWAマニフェスト
- `thanks.html` - フィードバック送信後のサンクスページ
- `netlify.toml` - Netlify設定

## 🎮 操作方法

1. **プレイヤー数設定** - 2-12人から選択
2. **カード配布** - 「カードを配る」でホールカード2枚を配布
3. **コミュニティカード** - 「フロップ」「ターン」「リバー」で段階的に公開
4. **ショーダウン** - 「ショーダウン」で勝者判定とチョップ検出

## 🔧 開発・デプロイ

### ローカル開発
```bash
# 簡易サーバー起動
npm start
# ブラウザで http://localhost:3000 を開く
```

### Netlifyデプロイ
- GitHubリポジトリと連携
- プッシュ時に自動デプロイ
- Netlify Formsでフィードバック受信

## 🐛 バグ修正履歴

### 役判定の修正
- **7枚評価の改善** - 組み合わせ生成による正確な最強5枚選択
- **ストレート判定修正** - A-2-3-4-5の正確な判定（[2,3,4,5,14]のみ）
- **同カテゴリ比較改善** - ストレート、ツーペア、ワンペアの正しいキッカー比較
- **チョップ検出追加** - 同じ手の強さの自動検出と表示

### PWA機能の追加
- **キャッシュ制御** - スタンドアロンモードでの異常終了検出とキャッシュクリア
- **フィードバック機能** - Netlify Forms + ソーシャルシェア

## 📄 ライセンス
Copyright (C) 2025 D.D Poker Takadanobaba. All Rights Reserved.



- chore: trigger Netlify redeploy 2025-10-15 22:00:55
