<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=3.0, minimum-scale=0.5">
  <title>Poker Flip App</title>
  <meta name="description" content="ãƒˆãƒ©ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ã‚’ãƒ•ãƒªãƒƒãƒ—ã—ã¦è¡¨ç¤ºã™ã‚‹ãƒŸãƒ‹ã‚¢ãƒ—ãƒª">
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-C6V53GTSQX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-C6V53GTSQX');
  </script>
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7286325354162680"
     crossorigin="anonymous"></script>
  
  <!-- OGPè¨­å®šï¼ˆLINEè»¢é€æ™‚ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ï¼‰ -->
  <meta property="og:title" content="Poker Flip App">
  <meta property="og:description" content="ãƒˆãƒ©ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ã‚’ãƒ•ãƒªãƒƒãƒ—ã—ã¦è¡¨ç¤ºã™ã‚‹ãƒãƒ¼ã‚«ãƒ¼ã‚¢ãƒ—ãƒª">
  <meta property="og:image" content="./icons/icon-512x512.png">
  <meta property="og:image:width" content="512">
  <meta property="og:image:height" content="512">
  <meta property="og:image:type" content="image/png">
  <meta property="og:url" content="https://poker-flip-app.netlify.app/">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Poker Flip App">
  <meta property="og:locale" content="ja_JP">
  
  <!-- Twitter Cardè¨­å®š -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Poker Flip App">
  <meta name="twitter:description" content="ãƒˆãƒ©ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ã‚’ãƒ•ãƒªãƒƒãƒ—ã—ã¦è¡¨ç¤ºã™ã‚‹ãƒãƒ¼ã‚«ãƒ¼ã‚¢ãƒ—ãƒª">
  <meta name="twitter:image" content="./icons/icon-512x512.png">
  
  <!-- LINEç”¨ã®è¿½åŠ è¨­å®š -->
  <meta name="application-name" content="Poker Flip App">
  <meta name="msapplication-TileImage" content="./icons/icon-192x192.png">
  <meta name="msapplication-TileColor" content="#ff9f43">
  
  <!-- PWAè¨­å®š -->
  <meta name="theme-color" content="#ff9f43">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Poker Flip">
  <meta name="msapplication-tap-highlight" content="no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no">
  
  <!-- ã‚¢ã‚¤ã‚³ãƒ³è¨­å®š -->
  <link rel="icon" type="image/png" sizes="32x32" href="./icons/icon-192x192.png">
  <link rel="icon" type="image/png" sizes="192x192" href="./icons/icon-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="./icons/icon-512x512.png">
  <link rel="apple-touch-icon" sizes="192x192" href="./icons/icon-192x192.png">
  <link rel="apple-touch-icon" sizes="512x512" href="./icons/icon-512x512.png">
  
  <!-- Web App Manifest -->
  <link rel="manifest" href="./manifest.json">
  
  <link rel="stylesheet" href="./cards.css?v=20251017-2">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    
    * {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #ffb366 0%, #ff9f43 50%, #ff8c42 100%);
      background-attachment: fixed;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      transform: translateZ(0);
      -webkit-transform: translateZ(0);
      will-change: scroll-position;
    }
    
    /* ã‚¹ãƒãƒ›ç‰ˆã§ã¯å®Œå…¨ã«ç•°ãªã‚‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    @media (max-width: 768px) {
      body {
        display: block !important;
        align-items: stretch !important;
        justify-content: flex-start !important;
        padding: 12px !important;
        min-height: 100vh !important;
      }
      
      .container {
        margin: 0 !important;
        max-width: 100% !important;
        border-radius: 12px !important;
        padding: 16px !important;
      }
    }

    .container {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
      padding: 24px;
      width: 100%;
      max-width: 960px;
      box-sizing: border-box;
    }

    /* PCè¡¨ç¤ºæ™‚: ãƒšãƒ¼ã‚¸å…¨ä½“ã‚’ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã«ã—ã€ä¸­å¤®å¯„ã› */
    @media (min-width: 769px) {
      html {
        overflow-y: scroll !important; /* å¸¸ã«ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã‚’å‡ºã—ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç¢ºå®š */
      }
      html, body {
        height: auto !important;
        overflow-y: auto !important;
      }
      body {
        display: block !important;
        align-items: initial !important;
        justify-content: initial !important;
        min-height: auto !important;
        overflow-y: auto !important;
        transform: none !important;
        -webkit-transform: none !important;
        will-change: auto !important;
        background-attachment: scroll !important; /* å›ºå®šèƒŒæ™¯ãŒã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’é˜»å®³ã™ã‚‹å¯èƒ½æ€§ã‚’æ’é™¤ */
        position: static !important;
      }
      .container {
        margin: 24px auto !important;
        max-height: none !important;
        overflow: visible !important;
      }
    }

    h1 {
      margin: 0 0 16px;
      text-align: center;
      color: #333;
    }

    .toolbar {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      background: #667eea;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(102,126,234,0.4);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    #revealBoardBtn {
      background: linear-gradient(135deg, #ff6b9d 0%, #ff8fab 100%);
      box-shadow: 0 4px 12px rgba(255,107,157,0.4);
    }

    #revealBoardBtn:hover {
      background: linear-gradient(135deg, #ff5a8a 0%, #ff7fa1 100%);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(80px, 1fr));
      gap: 12px;
      justify-items: center;
    }

    @media (max-width: 640px) {
      .grid { grid-template-columns: repeat(3, 1fr); }
    }

    .copyright {
      text-align: center;
      font-size: 12px;
      color: #333;
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid rgba(0, 0, 0, 0.2);
      font-family: Arial, sans-serif;
      letter-spacing: 0.5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Poker Flip App</h1>
    
    

    <h2 style="margin:0 0 8px; text-align:center; color:#333; font-size:18px;">NLH ãƒ•ãƒªãƒƒãƒ—ã‚¢ã‚¦ãƒˆ</h2>
    <div class="toolbar" id="nlhToolbar">
      <label style="display:flex; align-items:center; gap:8px; font-weight:bold; color:#333;">
        ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼äººæ•°
        <input id="playersCount" type="number" min="2" max="12" step="1" value="6" style="width:64px; padding:10px 12px; border-radius:10px; border:1px solid #ccc; font-size:14px;">
        <button id="playersInc" class="btn" aria-label="äººæ•°ã‚’å¢—ã‚„ã™" style="padding:6px 10px; line-height:1;">â–²</button>
        <button id="playersDec" class="btn" aria-label="äººæ•°ã‚’æ¸›ã‚‰ã™" style="padding:6px 10px; line-height:1;">â–¼</button>
      </label>
      <button class="btn" id="startFlipoutBtn" aria-label="æ–°ã—ã„ãƒãƒ³ãƒ‰ã‚’é–‹å§‹">æ–°ã—ã„ãƒãƒ³ãƒ‰</button>
      <button class="btn" id="revealBoardBtn" aria-label="ãƒœãƒ¼ãƒ‰ã‚«ãƒ¼ãƒ‰ã‚’é †ã«å…¬é–‹">ãƒœãƒ¼ãƒ‰ã‚’å‡ºã™</button>
      <button class="btn" id="showdownBtn" aria-label="ã‚·ãƒ§ãƒ¼ãƒ€ã‚¦ãƒ³ã—ã¦å½¹ã‚’åˆ¤å®š">ã‚·ãƒ§ãƒ¼ãƒ€ã‚¦ãƒ³ï¼ˆå½¹ã®åˆ¤å®šï¼‰</button>
    </div>

    <div id="tableArea">
      <div style="display:flex; align-items:center; justify-content:center; gap:16px; width:100%;">
        <div class="board-holder">
          <div id="community" class="board-row"></div>
        </div>
      </div>
      <div id="seats" class="seats"></div>
      <div id="status" class="status"></div>
    </div>

    <!-- ã‚³ãƒ”ãƒ¼ãƒ©ã‚¤ãƒˆ -->
    <div class="copyright">
      Â© 2025 D.DğŸ. All rights reserved.
    </div>
    
    <!-- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆä¸å…·åˆ/ã‚³ãƒ¡ãƒ³ãƒˆï¼‰ç°¡æ˜“ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="feedback-footer" aria-label="ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ•ã‚©ãƒ¼ãƒ ">
      <form name="feedback" method="POST" data-netlify="true" action="/thanks.html">
        <input type="hidden" name="form-name" value="feedback">
        <label class="sr-only" for="fb-message">ä¸å…·åˆã‚„ã”æ„è¦‹</label>
        <textarea id="fb-message" name="message" rows="2" maxlength="500" placeholder="ä¸å…·åˆã‚„ã‚¢ãƒ—ãƒªã®æ„Ÿæƒ³ãŒã‚ã‚Œã°ã©ã†ãï¼ˆä»»æ„ï¼‰"></textarea>
        <div class="feedback-row">
          <input type="email" name="email" placeholder="è¿”ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«ï¼ˆä»»æ„ï¼‰">
          <button type="submit" class="btn" aria-label="ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’é€ä¿¡">é€ä¿¡</button>
        </div>
      </form>
      <div class="version-info">v2.0.0</div>
    </div>
    
  </div>

  <script type="module" src="./cards.js?v=20251017-2"></script>
  
  <!-- Service Workerç™»éŒ² -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then((registration) => {
            console.log('Service Worker registered successfully:', registration.scope);
          })
          .catch((error) => {
            console.log('Service Worker registration failed:', error);
          });
      });
    }
    
    // PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¿ƒé€²
    let deferredPrompt;
    
    window.addEventListener('beforeinstallprompt', (e) => {
      console.log('PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½');
      e.preventDefault();
      deferredPrompt = e;
      
      // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
      const installBtn = document.createElement('button');
      installBtn.textContent = 'ğŸ“± ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«';
      installBtn.className = 'btn';
      installBtn.style.margin = '8px';
      installBtn.style.background = 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)';
      installBtn.style.boxShadow = '0 4px 12px rgba(34,197,94,0.4)';
      
      installBtn.setAttribute('aria-label', 'ã“ã®ã‚¢ãƒ—ãƒªã‚’ãƒ›ãƒ¼ãƒ ç”»é¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«');

      installBtn.addEventListener('click', () => {
        if (deferredPrompt) {
          deferredPrompt.prompt();
          deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
              console.log('PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰¿èª');
            } else {
              console.log('PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‹’å¦');
            }
            deferredPrompt = null;
            installBtn.remove();
          });
        }
      });
      
      // ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã«è¿½åŠ 
      const toolbar = document.querySelector('.toolbar');
      if (toolbar) {
        toolbar.appendChild(installBtn);
      }
    });
    
    // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†ã®æ¤œçŸ¥
    window.addEventListener('appinstalled', (evt) => {
      console.log('PWAãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã—ãŸ');
    });
  </script>
  
  <!-- PWAã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥è‡ªå‹•ã‚¯ãƒªã‚¢ï¼†SWè§£é™¤ï¼ˆãƒ›ãƒ¼ãƒ ç”»é¢èµ·å‹•æ™‚ã®ã¿ï¼‰ -->
  <script>
    (function setupOfflineAutoClear() {
      const isStandalone = () => (
        window.matchMedia('(display-mode: standalone)').matches ||
        window.navigator.standalone === true
      );
      async function clearCachesAndUnregister() {
        try {
          if (window.caches) {
            const names = await caches.keys();
            await Promise.all(names.map((n) => caches.delete(n)));
          }
        } catch (e) {
          console.log('Cache clear failed', e);
        }
        try {
          if (navigator.serviceWorker) {
            const regs = await navigator.serviceWorker.getRegistrations();
            await Promise.all(regs.map((r) => r.unregister()));
          }
        } catch (e) {
          console.log('SW unregister failed', e);
        }
      }
      window.addEventListener('offline', async () => {
        if (!isStandalone()) return;
        console.log('Offline detected in standalone - clearing caches and unregistering SW');
        await clearCachesAndUnregister();
      });
    })();
  </script>
  
  <!-- å‰å›æœªè§£æ”¾ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¤œçŸ¥â†’æ¬¡å›èµ·å‹•æ™‚ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨SWã‚’ã‚¯ãƒªã‚¢ï¼ˆãƒ›ãƒ¼ãƒ èµ·å‹•æ™‚ã®ã¿ï¼‰ -->
  <script>
    (function sessionClearOnNextLaunch() {
      const isStandalone = () => (
        window.matchMedia('(display-mode: standalone)').matches ||
        window.navigator.standalone === true
      );
      const SESSION_FLAG = 'pfa_session_open';
      async function clearAll() {
        try {
          if (window.caches) {
            const names = await caches.keys();
            await Promise.all(names.map((n) => caches.delete(n)));
          }
        } catch (e) { console.log('Cache clear failed', e); }
        try {
          if (navigator.serviceWorker) {
            const regs = await navigator.serviceWorker.getRegistrations();
            await Promise.all(regs.map((r) => r.unregister()));
          }
        } catch (e) { console.log('SW unregister failed', e); }
      }
      document.addEventListener('DOMContentLoaded', async () => {
        if (!isStandalone()) return;
        const wasOpen = localStorage.getItem(SESSION_FLAG) === '1';
        if (wasOpen) {
          console.log('Previous session not closed - clearing caches and unregistering SW');
          await clearAll();
        }
        localStorage.setItem(SESSION_FLAG, '1');
      });
      window.addEventListener('pagehide', () => {
        if (isStandalone()) localStorage.removeItem(SESSION_FLAG);
      });
      window.addEventListener('beforeunload', () => {
        if (isStandalone()) localStorage.removeItem(SESSION_FLAG);
      });
    })();
  </script>
  
  <script type="module">
    import { startNewHand, startNewHandAnimated, showdown, autoReveal } from './cards.js';

    const seats = document.getElementById('seats');
    const community = document.getElementById('community');
    const statusEl = document.getElementById('status');
    
    // ã‚¹ãƒãƒ›ã§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å•é¡Œã‚’å¼·åˆ¶çš„ã«è§£æ±º
    function ensureMobileScroll() {
      if (window.innerWidth <= 768) {
        document.body.style.display = 'block';
        document.body.style.alignItems = 'stretch';
        document.body.style.justifyContent = 'flex-start';
        document.body.style.minHeight = '100vh';
        
        const container = document.querySelector('.container');
        if (container) {
          container.style.margin = '0';
          container.style.maxWidth = '100%';
        }
        
        // å¼·åˆ¶çš„ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã«ã™ã‚‹
        document.documentElement.style.height = 'auto';
        document.body.style.height = 'auto';
        document.body.style.maxHeight = 'none';
      }
    }
    
    // PCã§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å•é¡Œã‚’å¼·åˆ¶çš„ã«è§£æ±ºï¼ˆç‰¹ã«åˆå›ã«äººæ•°ãŒå¤šã„å ´åˆï¼‰
    function ensureDesktopScroll() {
      if (window.innerWidth >= 769) {
        document.documentElement.style.height = 'auto';
        document.documentElement.style.overflowY = 'auto';
        document.body.style.height = 'auto';
        document.body.style.overflowY = 'auto';
        document.body.style.transform = 'none';
        document.body.style.webkitTransform = 'none';
        document.body.style.willChange = 'auto';
        document.body.style.backgroundAttachment = 'scroll';
        document.body.style.position = 'static';
      }
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã¨ãƒªã‚µã‚¤ã‚ºæ™‚ã«å®Ÿè¡Œ
    ensureMobileScroll();
    ensureDesktopScroll();
    window.addEventListener('resize', ensureMobileScroll);
    window.addEventListener('resize', ensureDesktopScroll);

    // NLH Flipout controls
    const playersCountInput = document.getElementById('playersCount');
    const startFlipoutBtn = document.getElementById('startFlipoutBtn');
    const revealBoardBtn = document.getElementById('revealBoardBtn');
    const showdownBtn = document.getElementById('showdownBtn');
    const playersInc = document.getElementById('playersInc');
    const playersDec = document.getElementById('playersDec');
    

    // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¡ˆå†…ã‚’éš ã™ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆAndroidãƒœã‚¿ãƒ³/iOSãƒ’ãƒ³ãƒˆã®ä¸¡æ–¹ã‚’å¯¾è±¡ï¼‰
    function hideInstallPrompt() {
      const btn = document.querySelector('button[aria-label="ã“ã®ã‚¢ãƒ—ãƒªã‚’ãƒ›ãƒ¼ãƒ ç”»é¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"]');
      if (btn) btn.remove();
      const iosHint = document.getElementById('iosInstallHint');
      if (iosHint) iosHint.remove();
    }

    // NLH Flipout events
    startFlipoutBtn.addEventListener('click', async () => {
      hideInstallPrompt();
      const n = Math.max(2, Math.min(12, parseInt(playersCountInput.value || '6', 10)));
      await startNewHandAnimated({ 
        seatsEl: seats, 
        communityEl: community, 
        statusEl, 
        numPlayers: n,
        onDone: () => {
          // åˆå›ã‹ã‚‰äººæ•°ãŒå¤šã„å ´åˆã§ã‚‚ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã«ã™ã‚‹
          ensureDesktopScroll();
          // å¿µã®ãŸã‚ã€åº§å¸­ã‚¨ãƒªã‚¢ã®æœ€å¾Œã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆé•·ã„ç”»é¢ã§åŠ¹æœï¼‰
          try {
            const lastSeat = seats.lastElementChild;
            // PCã§ã¯å‹æ‰‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ãªã„ã€‚ãƒ¢ãƒã‚¤ãƒ«æ™‚ã®ã¿å®Ÿè¡Œ
            if (window.innerWidth <= 768 && lastSeat) {
              lastSeat.scrollIntoView({ behavior: 'auto', block: 'end' });
            }
          } catch (_) {}
        }
      });
    });

    // æ‰‹å‹•ã®ãƒ•ãƒ­ãƒƒãƒ—/ã‚¿ãƒ¼ãƒ³/ãƒªãƒãƒ¼ã¯å‰Šé™¤ï¼ˆè‡ªå‹•é€²è¡Œã«ä¸€æœ¬åŒ–ï¼‰

    showdownBtn.addEventListener('click', () => {
      hideInstallPrompt();
      showdown();
    });


    // ãƒœãƒ¼ãƒ‰ã‚’å‡ºã™: ãƒ•ãƒ­ãƒƒãƒ—â†’ã‚¿ãƒ¼ãƒ³â†’ãƒªãƒãƒ¼ã®è‡ªå‹•å…¬é–‹
    revealBoardBtn.addEventListener('click', () => {
      hideInstallPrompt();
      autoReveal({ flopDelayMs: 600, turnDelayMs: 1000, riverDelayMs: 1000, autoShowdown: false });
    });

    // --- iOS Safariå‘ã‘: beforeinstallpromptãŒç„¡ã„ãŸã‚ã€ãƒˆãƒƒãƒ—ã®ã¿ãƒ’ãƒ³ãƒˆã‚’è¡¨ç¤º ---
    (function showIosInstallHintIfNeeded() {
      const ua = navigator.userAgent || navigator.vendor || window.opera;
      const isIOS = /iPad|iPhone|iPod/.test(ua);
      const isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true;
      const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
      if (isIOS && isSafari && !isStandalone) {
        const toolbar = document.querySelector('.toolbar');
        if (!toolbar) return;
        const hint = document.createElement('div');
        hint.id = 'iosInstallHint';
        hint.setAttribute('role', 'status');
        hint.setAttribute('aria-live', 'polite');
        hint.style.padding = '8px 12px';
        hint.style.borderRadius = '8px';
        hint.style.background = 'rgba(0,0,0,0.06)';
        hint.style.color = '#333';
        hint.style.fontSize = '12px';
        hint.style.display = 'flex';
        hint.style.alignItems = 'center';
        hint.style.gap = '8px';
        hint.style.maxWidth = '100%';
        hint.innerHTML = 'ğŸ“² ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã™ã‚‹ã«ã¯ã€Safariã®å…±æœ‰ãƒœã‚¿ãƒ³ã‹ã‚‰ã€Œãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚';
        toolbar.appendChild(hint);
      }
    })();

    // äººæ•°ã®ä¸Šä¸‹ãƒœã‚¿ãƒ³ã¨å…¥åŠ›ã®ã‚¯ãƒ©ãƒ³ãƒ—
    function clampPlayers(val) {
      const n = Math.max(2, Math.min(12, parseInt(val || '6', 10)));
      playersCountInput.value = String(n);
      return n;
    }
    playersInc.addEventListener('click', () => {
      clampPlayers((parseInt(playersCountInput.value || '6', 10) + 1).toString());
    });
    playersDec.addEventListener('click', () => {
      clampPlayers((parseInt(playersCountInput.value || '6', 10) - 1).toString());
    });
    playersCountInput.addEventListener('change', () => clampPlayers(playersCountInput.value));
    playersCountInput.addEventListener('blur', () => clampPlayers(playersCountInput.value));
    
    // ã‚¢ãƒ—ãƒªãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’åˆæœŸåŒ–
    import('./cards.js').then(module => {
      if (module.initAppLifecycleManager) {
        module.initAppLifecycleManager();
      }
    }).catch(error => {
      console.log('Failed to initialize app lifecycle manager:', error);
    });
  </script>
</body>
</html>


